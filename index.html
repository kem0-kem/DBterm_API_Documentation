<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>DBterm API Documentation â€” Donation Transparency System</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 30px;
            line-height: 1.6;
            color: #333;
        }
        h1, h2, h3, h4 {
            color: #222;
        }
        code {
            background: #f4f4f4;
            padding: 4px 6px;
            border-radius: 4px;
        }
        pre {
            background: #f4f4f4;
            padding: 12px;
            border-radius: 4px;
            overflow-x: auto;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 10px;
            margin-bottom: 20px;
        }
        table, th, td {
            border: 1px solid #bbb;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
        th {
            background: #efefef;
        }
        .method-post, .method-get, .method-patch {
            display: inline-block;
            padding: 4px 8px;
            color: white;
            border-radius: 4px;
            font-weight: bold;
        }
        .method-post { background: #1976d2; }
        .method-get { background: #4caf50; }
        .method-patch { background: #ff9800; }
    </style>
</head>

<body>

<h1>ğŸ“˜ DBterm API Documentation â€” Donation Transparency System</h1>
<p><strong>Note:</strong> íšŒì›ê°€ì…/ë¡œê·¸ì¸ì„ ì œì™¸í•œ ëª¨ë“  APIëŠ” <code>Authorization: Bearer {token}</code> í—¤ë”ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>
<hr>

<!-- A. AUTH -->
<h2>A. ì¸ì¦ ë° ì‚¬ìš©ì ê´€ë¦¬ (Auth & Users)</h2>

<h3>A-1. íšŒì›ê°€ì… (Sign Up)</h3>
<p><span class="method-post">POST</span> <code>/api/auth/signup</code></p>

<h4>Request Body</h4>
<pre>{
  "username": "testUser1",
  "password": "1234",
  "name": "í™ê¸¸ë™",
  "phoneNum": "010-1234-5678"
}</pre>

<h4>Response (201 Created)</h4>
<pre>"signup success"</pre>

<hr>

<h3>A-2. ë¡œê·¸ì¸ (Login)</h3>
<p><span class="method-post">POST</span> <code>/api/auth/login</code></p>

<h4>Request Body</h4>
<pre>{
  "username": "testUser1",
  "password": "1234"
}</pre>

<h4>Response (200 OK)</h4>
<pre>{
  "token": "JWT-TOKEN-HERE",
  "role": "DONOR",
  "userId": 1
}</pre>

<hr>

<h3>A-3. ë‚´ ì •ë³´ ìˆ˜ì • (Update Profile)</h3>
<p><span class="method-patch">PATCH</span> <code>/api/auth/me</code></p>

<h4>Request Body</h4>
<pre>{
  "name": "ìƒˆ ì´ë¦„",
  "isAnonymous": true
}</pre>

<hr><hr>

<!-- B. DONOR -->
<h2>B. í›„ì›ì (Donor)</h2>

<h3>B-1. í›„ì› ë“±ë¡ (Create Donation)</h3>
<p><span class="method-post">POST</span> <code>/api/donations</code></p>

<pre>{
  "campaignId": 5,
  "amount": 50000,
  "paymentMethod": "CARD"
}</pre>

<hr>

<h3>B-2. ë‚´ í›„ì› ë‚´ì—­ ì¡°íšŒ</h3>
<p><span class="method-get">GET</span> <code>/api/donations/me?period=this_month&sortBy=amount&order=desc</code></p>

<hr>

<h3>B-3. í›„ì›ê¸ˆ ì‚¬ìš©ì²˜ ì¶”ì </h3>
<p><span class="method-get">GET</span> <code>/api/donations/{donationId}/trace</code></p>

<hr><hr>

<!-- C. OPERATOR -->
<h2>C. ìš´ì˜ì (Operator)</h2>

<h3>C-1. ìº í˜ì¸ ìƒì„±</h3>
<p><span class="method-post">POST</span> <code>/api/campaigns</code></p>

<pre>{
  "name": "ì¥ì•  ì•„ë™ ë³´í˜¸ ìº í˜ì¸",
  "department": "Community",
  "goalAmount": 5000000,
  "description": "ì„¤ëª… ë‚´ìš©",
  "startDate": "2025-01-01",
  "endDate": "2025-12-31"
}</pre>

<hr>

<h3>C-2. ìº í˜ì¸ ëª©ë¡ ì¡°íšŒ</h3>
<p><span class="method-get">GET</span> <code>/api/campaigns?status=active&sortBy=name</code></p>

<hr>

<h3>C-3. ë¯¸ê²€ì¦ ê¸°ë¶€ ì¡°íšŒ</h3>
<p><span class="method-get">GET</span> <code>/api/donations/unverified?date=today</code></p>

<hr>

<h3>C-4. ê¸°ë¶€ ê²€ì¦</h3>
<p><span class="method-patch">PATCH</span> <code>/api/donations/{id}/verify</code></p>

<hr>

<h3>C-5. ìë™ ë°°ë¶„ì•ˆ ê²€í†  ë° ìŠ¹ì¸</h3>
<p><span class="method-post">POST</span> <code>/api/allocations/approve</code></p>

<pre>{
  "allocationIds": [10, 11, 12]
}</pre>

<hr><hr>

<!-- D. ACCOUNTANT -->
<h2>D. íšŒê³„ ë‹´ë‹¹ì (Accountant)</h2>

<h3>D-1. ìˆ˜í˜œì ë“±ë¡</h3>
<p><span class="method-post">POST</span> <code>/api/receivers</code></p>

<pre>{
  "name": "ë¶€ì‚° ì•„ë™ì„¼í„°",
  "type": "NGO",
  "bankAccount": "123-456-789"
}</pre>

<hr>

<h3>D-2. ìŠ¹ì¸ëœ ë°°ë¶„ ëª©ë¡ ì¡°íšŒ</h3>
<p><span class="method-get">GET</span> <code>/api/allocations/approved</code></p>

<hr>

<h3>D-3. ì§€ê¸‰ ê¸°ë¡ ìƒì„± (Disbursement)</h3>
<p><span class="method-post">POST</span> <code>/api/disbursements</code></p>

<pre>{
  "allocationId": 10,
  "amount": 50000,
  "paymentTxRef": "BANK_TX_12345"
}</pre>

<hr>

<h3>D-4. ì¦ë¹™ ë¬¸ì„œ ë©”íƒ€ë°ì´í„° ì €ì¥</h3>
<p><span class="method-post">POST</span> <code>/api/documents</code></p>

<pre>{
  "disbursementId": 5,
  "storagePath": "/s3/receipts/2025-01/file.pdf",
  "fileHash": "a1b2c3d4e5f6"
}</pre>

<hr><hr>

<!-- E. AUDITOR -->
<h2>E. ê°ì‚¬ ë‹´ë‹¹ì (Auditor)</h2>

<h3>E-1. ê°ì‚¬ ë¡œê·¸ ì¡°íšŒ</h3>
<p><span class="method-get">GET</span> <code>/api/audit/logs?table=donations&dateFrom=2025-01-01</code></p>

<hr>

<h3>E-2. ë°°ë¶„Â·ì§€ê¸‰ ê¸ˆì•¡ ë¶ˆì¼ì¹˜ ì¡°íšŒ</h3>
<p><span class="method-get">GET</span> <code>/api/audit/mismatch</code></p>

<hr>

<h3>E-3. ë¬¸ì„œ í•´ì‹œ ê²€ì¦ ëª©ë¡</h3>
<p><span class="method-get">GET</span> <code>/api/documents/hashes?dateFrom=2025-01-01</code></p>

<hr>

</body>
</html>
